import { NextResponse } from "next/server";
import type { NextRequest } from "next/server";
import { init as initEvents } from "@sitecore-cloudsdk/events/server";
import { init as initPersonalize } from "@sitecore-cloudsdk/personalize/server";

export async function middleware(request: NextRequest) {
  const response = NextResponse.next();
  
  await initEvents(
    {
      sitecoreEdgeContextId: "83d8199c-2837-4c29-a8ab-1bf234fea2d1",
      cookieExpiryDays: 400,
      enableServerCookie: true,
      sitecoreEdgeUrl: undefined,
      siteName: "spinair.com",
    },
    request,
    response
  );

  await initPersonalize(
    {
      sitecoreEdgeContextId: "83d8199c-2837-4c29-a8ab-1bf234fea2d1",
      cookieExpiryDays: 400,
      enableServerCookie: true,
      sitecoreEdgeUrl: undefined,
      siteName: "spinair.com",
    },
    request,
    response
  );

  return response;
}
