import { NextResponse } from "next/server";
import type { NextRequest } from "next/server";
import { CloudSDK } from '@sitecore-cloudsdk/core/server';
import "@sitecore-cloudsdk/events/server";
import "@sitecore-cloudsdk/personalize/server";
import "@sitecore-cloudsdk/search-api-client/server";

export async function middleware(request: NextRequest) {
  const response = NextResponse.next();
  await CloudSDK(request, response, {
      sitecoreEdgeContextId: "83d8199c-2837-4c29-a8ab-1bf234fea2d1",
      cookieExpiryDays: 400,
      enableServerCookie: true,
      siteName: "spinair.com",
    })
      .addEvents()
      .addPersonalize()
      .addSearch({ userId: 'test' })
      .initialize();

  return response;
}
